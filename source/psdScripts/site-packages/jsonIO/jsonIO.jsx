// Copyright (c) 2021 Tatsuya Nakamori

// Create JSONIO object
if (typeof JSONIO !== "object") {
    JSONIO = {};
}

(function () {
    "use strict";

    // jsonを使えるようにするためのセットアップ
    var json2File = new File($.fileName + "/../../json2/json2.jsx");
    $.evalFile(json2File);

    // Load JSON
    if (typeof JSONIO.load !== "function") {
        JSONIO.load = function (filename) {
            var f = new File(filename);
            f.encoding = "UTF-8";

            var isOpened = f.open("r");
            if (isOpened) {
                try {
                    var contents = f.read();
                } finally {
                    f.close();
                }
            }

            return JSON.parse(contents)
        }
    }

    // Dump JSON
    if (typeof JSONIO.dump !== "function") {
        JSONIO.dump = function (filename, data) {
            var contents = JSON.stringify(data, undefined, 4);

            var f = new File(filename);
            f.encoding = "UTF-8";

            var isOpened = f.open("w");
            if (isOpened) {
                try {
                    f.write(contents);
                } finally {
                    f.close();
                }
            }
        }
    }
}());
